function removeAlertMsg(e){null!=e.querySelector(".playlistAlertMsg")&&(e.removeChild(e.querySelector(".playlistAlertMsg")),clearInterval(clearAlertMsg))}function clearPlaylistContainer(e){for(;null!==e.firstElementChild;)e.removeChild(e.firstElementChild)}function searchFieldValue(e,t){for(var l=t.childElementCount,a=0;l>a;a++){var i=t.children[a].querySelector(".playlistNameElement");void 0!==document.body.dataset?currentElementValue=t.children[a].querySelector(".playlistCheckbox").dataset.pname:currentElementValue=t.children[a].querySelector(".playlistCheckbox").getAttribute("data-pname"),currentElementValue=currentElementValue.toLowerCase(),currentElementValue=currentElementValue.charAt(0).toUpperCase()+currentElementValue.slice(1),e=e.toLowerCase(),e=e.charAt(0).toUpperCase()+e.slice(1),currentElementValue=currentElementValue.length>16?currentElementValue.slice(0,16)+"...":currentElementValue,0==currentElementValue.indexOf(e)&&e.length>0?(i.innerHTML=currentElementValue.replace(e,'<span style="color:blue;font-weight:bold">'+e+"</span>"),t.insertBefore(t.children[a],t.firstElementChild)):i.innerHTML=currentElementValue}}url=adminurl+"admin-ajax.php";var playlistButton=document.getElementsByClassName("playlistIcon");if(0!=playlistButton.length){var tickImage=pluginUrl+"images/tick.png",playlistElement=document.createElement("div");playlistElement.className="playlistOuterBox";var playlistInnerBox=document.createElement("div");playlistInnerBox.className="playlistInnerBox";var playlistSearchBox=document.createElement("div");playlistSearchBox.className="playlistSearchBox";var playlistCreateSpan=document.createElement("span");playlistCreateSpan.className="playlistSearchImage",void 0!==document.body.dataset?playlistCreateSpan.dataset.showfield="create":playlistCreateSpan.setAttribute("data-showfield","create");var playlistCreateImg=document.createElement("img");playlistCreateImg.src=pluginUrl+"images/playlist_create.png",playlistCreateImg.title="Create new playlist",playlistCreateImg.className="createImageIcon";var playlistSearchSpan=document.createElement("span");playlistSearchSpan.className="playlistSearchImage",void 0!==document.body.dataset?playlistSearchSpan.dataset.showfield="search":playlistSearchSpan.setAttribute("data-showfield","search");var playlistSearchImg=document.createElement("img");playlistSearchImg.src=pluginUrl+"images/playlist_search.png",playlistSearchImg.title="Search playlist",playlistSearchImg.className="searchImageIcon";var playlistSearchField=document.createElement("input");playlistSearchField.type="text",playlistSearchField.className="playlistTextField",void 0!==document.body.dataset?playlistSearchField.dataset.action="":playlistSearchField.setAttribute("data-action","");var playlistContainer=document.createElement("div");playlistContainer.className="playlistContainer",playlistCreateSpan.appendChild(playlistCreateImg),playlistSearchSpan.appendChild(playlistSearchImg),playlistSearchBox.appendChild(playlistCreateSpan),playlistSearchBox.appendChild(playlistSearchSpan),playlistSearchBox.appendChild(playlistSearchField),playlistInnerBox.appendChild(playlistSearchBox),playlistInnerBox.appendChild(playlistContainer),playlistElement.appendChild(playlistInnerBox);for(var vid,clearAlertMsg,playlistActionButton=document.getElementsByClassName("playlistSearchImage"),playlistSearchField=document.getElementsByClassName("playlistTextField"),checkBoxHandle=function(){if(void 0!==document.body.dataset)var e=this.dataset.aid;else var e=this.getAttribute("data-aid");if(void 0!==document.body.dataset)var t=this.dataset.pid;else var t=this.getAttribute("data-pid");var l=document.getElementsByClassName("playlistSearchBox")[0],a=document.createElement("p"),i=document.createElement("img");i.src=pluginUrl+"images/loader.gif",i.className="playlistLoading",i.style.cssText="width:20px !important;height:20px !important",a.className="playlistLoadinElement",a.appendChild(i),l.appendChild(a),1==e&&(void 0!==document.body.dataset?this.dataset.aid=-2:this.setAttribute("data-aid",-2),this.style.cssText="background-image:url("+tickImage+")",jQuery.ajax({url:url,type:"POST",data:"&action=insertplaylistvideo&vid="+vid+"&pid="+t,success:function(e){l.removeChild(a);var t=jQuery.parseJSON(e);if(checkResult=t.checkResult,1==checkResult){null!=l.querySelector(".playlistAlertMsg")&&l.removeChild(l.querySelector(".playlistAlertMsg"));var i=document.createElement("p");i.className="playlistAlertMsg";var s=document.createTextNode("Added to playlist");return i.appendChild(s),l.appendChild(i),clearInterval(clearAlertMsg),clearAlertMsg=setInterval(function(){removeAlertMsg(l)},1e3),!1}return 0==checkResult?!1:void 0}})),-2==e&&(void 0!==document.body.dataset?this.dataset.aid=1:this.setAttribute("data-aid",1),this.style.cssText="",jQuery.ajax({url:url,type:"POST",data:"&action=removeplaylist&vid="+vid+"&pid="+t,success:function(e){l.removeChild(a);var t=jQuery.parseJSON(e);if(checkResult=t.checkResult,1==checkResult){null!=l.querySelector(".playlistAlertMsg")&&l.removeChild(l.querySelector(".playlistAlertMsg"));var i=document.createElement("p");i.className="playlistAlertMsg";var s=document.createTextNode("Removed from playlist");return i.appendChild(s),l.appendChild(i),clearInterval(clearAlertMsg),clearAlertMsg=setInterval(function(){removeAlertMsg(l)},1e3),!1}return 0==checkResult?!1:void 0}}))},playlistContainerBox,keyPressHandle=function(e){var t=(this.value,e.keyCode);if(void 0!==document.body.dataset)var l=this.dataset.action;else var l=this.getAttribute("data-action");var a,i=this.value,s=this.parentNode;if(13==t&&"create"==l){var r=document.createElement("p"),n=document.createElement("img");n.src=pluginUrl+"images/loader.gif",n.className="playlistLoading",n.style.cssText="width:20px !important;height:20px !important",r.className="playlistLoadinElement",r.appendChild(n),s.appendChild(r),jQuery.ajax({url:url,type:"POST",data:"&action=storeplaylist&vid="+vid+"&pname="+i,success:function(e){s.removeChild(r);var t=jQuery.parseJSON(e);if(a=t.status,checkResult=t.checkResult,1==checkResult){var l=document.createElement("div");l.className="playlistBox";var n=document.createElement("span"),d=document.createElement("span");d.className="playlistNameElement",n.className="playlistCheckbox",void 0!==document.body.dataset?n.dataset.pname=i:n.setAttribute("data-pname",i);var c=document.createTextNode(i.length>16?i.slice(0,16)+"...":i);if(d.appendChild(c),n.style.cssText="background-image:url("+tickImage+")",void 0!==document.body.dataset?n.dataset.aid=-2:n.setAttribute("data-aid",-2),l.appendChild(n),l.appendChild(d),"playlistBox"==playlistContainerBox.firstElementChild.className?playlistContainerBox.insertBefore(l,playlistContainerBox.firstElementChild):(clearPlaylistContainer(playlistContainerBox),playlistContainerBox.appendChild(l)),playlistContainerBox.childElementCount>5){var o=5*playlistContainerBox.firstElementChild.offsetHeight;playlistContainerBox.style.cssText="height:"+o+"px;overflow:auto"}else playlistContainerBox.style.cssText="height:auto";return n.addEventListener("click",checkBoxHandle,!1),!1}if(0==checkResult&&"limit"==a){var p=document.getElementsByClassName("playlistSearchBox")[0];null!=p.querySelector(".playlistAlertMsg")&&p.removeChild(p.querySelector(".playlistAlertMsg"));var m=document.createElement("p");m.className="playlistAlertMsg";var u=document.createTextNode("Exceeded playlist count");return m.appendChild(u),p.appendChild(m),clearInterval(clearAlertMsg),clearAlertMsg=setInterval(function(){removeAlertMsg(p)},1e3),!1}if(0==checkResult&&"exist"==a){var p=document.getElementsByClassName("playlistSearchBox")[0];null!=p.querySelector(".playlistAlertMsg")&&p.removeChild(p.querySelector(".playlistAlertMsg"));var m=document.createElement("p");m.className="playlistAlertMsg";var u=document.createTextNode("Already exist");return m.appendChild(u),p.appendChild(m),clearInterval(clearAlertMsg),clearAlertMsg=setInterval(function(){removeAlertMsg(p)},1e3),!1}return!1}})}("search"==l||"create"==l)&&"playlistBox"==playlistContainerBox.firstElementChild.className&&searchFieldValue(this.value,playlistContainerBox)},playlistActionHandle=function(){if(void 0!==document.body.dataset)var e=this.dataset.showfield;else var e=this.getAttribute("data-showfield");void 0!==document.body.dataset?playlistSearchField[0].dataset.action=e:playlistSearchField[0].setAttribute("data-action",e),playlistSearchField[0].removeAttribute("value"),"create"==e&&(playlistSearchField[0].value="",playlistSearchField[0].placeholder="Create new playlist"),"search"==e&&(playlistSearchField[0].value="",playlistSearchField[0].placeholder="Search playlist"),playlistSearchField[0].style.display="block"},playlistButtonHandle=function(e){vid=void 0!==document.body.dataset?this.dataset.vid:this.getAttribute("data-vid");var t=playlistElement.querySelector(".playlistTextField");t.value="",t.placeholder="",t.style.display="none";var l=this.parentNode,a=playlistElement.querySelector(".playlistContainer");a.style.cssText="height:auto",a.firstElementChild&&clearPlaylistContainer(a);var i=document.createElement("p"),s=document.createElement("img");s.src=pluginUrl+"images/loader.gif",s.className="playlistLoading",s.style.cssText="width:20px !important;height:20px !important",i.className="noPlaylistText",i.appendChild(s),a.appendChild(i),jQuery.ajax({url:url,type:"POST",data:"&action=getplaylist&vid="+vid,success:function(e){var t=jQuery.parseJSON(e);if(checkResult=t.checkResult,t.redirectURL&&""!=t.redirectURL)return window.location=t.redirectURL,!1;if(1==checkResult)var l=t.playlist.length,i=t.playlist,s=t.currentPlaylist;if(1==checkResult&&l>0){clearPlaylistContainer(a);for(var r=0;l>r;r++){var n=document.createElement("div");n.className="playlistBox";var d=document.createElement("span"),c=document.createElement("span");c.className="playlistNameElement",d.className="playlistCheckbox",void 0!==document.body.dataset?d.dataset.pname=i[r].playlist_name:d.setAttribute("data-pname",i[r].playlist_name),void 0!==document.body.dataset?d.dataset.pid=i[r].id:d.setAttribute("data-pid",i[r].id),void 0!==document.body.dataset?d.dataset.aid=1:d.setAttribute("data-aid",1);var o=document.createTextNode(i[r].playlist_name.length>16?i[r].playlist_name.slice(0,16)+"...":i[r].playlist_name);c.appendChild(o),s.indexOf(i[r].id)>-1?(d.style.cssText="background-image:url("+tickImage+")",void 0!==document.body.dataset?d.dataset.aid=-2:d.setAttribute("data-aid",-2),n.appendChild(d),n.appendChild(c),a.firstElementChild?a.insertBefore(n,a.firstElementChild):a.appendChild(n),d.addEventListener("click",checkBoxHandle,!1)):(d.value=i[r].playlist_name,n.appendChild(d),n.appendChild(c),a.appendChild(n),d.addEventListener("click",checkBoxHandle,!1))}if(a.childElementCount>5){var p=5*a.firstElementChild.offsetHeight;a.style.cssText="height:"+p+"px;overflow:auto"}else a.style.cssText="height:auto"}if(0==checkResult){a.removeChild(a.firstElementChild);var m=document.createElement("p");m.innerHTML="No playlist found",m.className="noPlaylistText",a.appendChild(m)}var u=window.innerHeight,y=playlistElement.getBoundingClientRect().top+playlistElement.offsetHeight;return y>u&&(hiddenBottomHeight=y-u,document.body.scrollTop?heightToScroll=document.body.scrollTop+hiddenBottomHeight+30:heightToScroll=document.documentElement.scrollTop+hiddenBottomHeight+30,window.scrollTo(0,heightToScroll)),!1}}),l.appendChild(playlistElement);for(var r=0;r<playlistActionButton.length;r++)playlistActionButton[r].addEventListener("click",playlistActionHandle,!1);playlistContainerBox=a,playlistSearchField[0].addEventListener("keyup",keyPressHandle,!1);var n=window.innerHeight,d=this.getBoundingClientRect().top+playlistElement.offsetHeight;d>n&&(hiddenBottomHeight=d-n,document.body.scrollTop?heightToScroll=document.body.scrollTop+hiddenBottomHeight+30:heightToScroll=document.documentElement.scrollTop+hiddenBottomHeight+30,window.scrollTo(0,heightToScroll))},i=0;i<playlistButton.length;i++)playlistButton[i].addEventListener("click",playlistButtonHandle,!1);var closePlaylistHandle=function(e){var t=document.getElementsByClassName("playlistOuterBox")[0];if(void 0!=t){var l=e.target.className,a=e.target,i=t.querySelectorAll("."+l);if("playlistIcon"==a.className||"playlistIconImg"==a.className)return!1;if(0==i.length){var s=document.getElementsByClassName("playlistOuterBox");if(s.length>0){var r=s[0].parentNode;r.removeChild(s[0])}}}};document.body.addEventListener("click",closePlaylistHandle,!1);for(var playlistImgBox=document.getElementsByClassName("playlistImgBox"),playlistImgBoxHandle=function(){var e=this.parentNode;if(void 0!==document.body.dataset){e.dataset.pid}else{e.getAttribute("data-pid")}for(var t=document.getElementsByClassName("playlistTemplateBox"),l=0;l<t.length;l++)setTimeout(function(){console.log(l)},0),t[l]!=this.parentNode},index=0;index<playlistImgBox.length;index++)playlistImgBox[index].addEventListener("click",playlistImgBoxHandle,!1)}